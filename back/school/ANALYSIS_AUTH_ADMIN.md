# –ê–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è

## ‚úÖ –°—Ç–∞—Ç—É—Å: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

1. **JWT-—Ç–æ–∫–µ–Ω—ã (JSON Web Tokens)**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `rest_framework_simplejwt`
   - –ü—Ä–∏ –ª–æ–≥–∏–Ω–µ/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤—ã–¥–∞—é—Ç—Å—è `access` –∏ `refresh` —Ç–æ–∫–µ–Ω—ã
   - –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –≤ `localStorage`

2. **–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
   - `ADMIN` - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (–ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø)
   - `MANAGER` - –ú–µ–Ω–µ–¥–∂–µ—Ä
   - `TEACHER` - –£—á–∏—Ç–µ–ª—å
   - `STUDENT` - –£—á–µ–Ω–∏–∫
   - `APPLICANT` - –ê–±–∏—Ç—É—Ä–∏–µ–Ω—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)

3. **–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (Permissions)**
   - `IsAdminRole` - —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
   - `IsManagerOrAdmin` - –º–µ–Ω–µ–¥–∂–µ—Ä—ã –∏ –∞–¥–º–∏–Ω—ã
   - `IsTeacherOrAdmin` - —É—á–∏—Ç–µ–ª—è –∏ –∞–¥–º–∏–Ω—ã
   - `IsStudentOrAdmin` - —É—á–µ–Ω–∏–∫–∏ –∏ –∞–¥–º–∏–Ω—ã
   - `IsApplicantOrAdmin` - –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç—ã –∏ –∞–¥–º–∏–Ω—ã

4. **API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã**
   - `/api/auth/register/` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
   - `/api/auth/login/` - –æ–±—ã—á–Ω—ã–π –≤—Ö–æ–¥
   - `/api/auth/admin-login/` - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –≤—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ –∏–∑ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞
   - `/api/auth/me/` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
   - `/api/auth/logout/` - –≤—ã—Ö–æ–¥

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `ADMIN_SEED_EMAILS` –≤ `settings.py`
   - –†–∞–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –≤ –∫–æ–¥–µ, –Ω–æ –Ω–µ –±—ã–ª –æ–ø—Ä–µ–¥–µ–ª—ë–Ω
   - –¢–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ email'–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–¥–º–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ `AdminLoginAPI`

### 2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –≤ `admin_api_views.py`
   - –£–¥–∞–ª—ë–Ω –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å `AdminSetRoleAPI`
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã

### 3. ‚úÖ –£–ª—É—á—à–µ–Ω —Å–∏–≥–Ω–∞–ª —Å–æ–∑–¥–∞–Ω–∏—è root-–∞–¥–º–∏–Ω–∞
   - –¢–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `username = email`
   - –ü–∞—Ä–æ–ª—å –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `ROOT_ADMIN_PASSWORD`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

---

## üë§ –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—à–∏—Ç—å –∞–¥–º–∏–Ω–∞ –≤ –∫–æ–¥

### –í–∞—Ä–∏–∞–Ω—Ç 1: Root Admin (–≤—à–∏—Ç—ã–π –∞–¥–º–∏–Ω) - –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø

**Root Admin** —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏—è—Ö —á–µ—Ä–µ–∑ —Å–∏–≥–Ω–∞–ª –≤ `accounts/signals.py`.

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
1. –í `settings.py` —É–∂–µ —É–∫–∞–∑–∞–Ω:
   ```python
   ROOT_ADMIN_EMAIL = "kazak_jenya@mail.ru"
   ```

2. –ü–∞—Ä–æ–ª—å –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```bash
   # Windows PowerShell
   $env:ROOT_ADMIN_PASSWORD="–í–∞—à–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π–ü–∞—Ä–æ–ª—å123!"
   
   # Linux/Mac
   export ROOT_ADMIN_PASSWORD="–í–∞—à–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π–ü–∞—Ä–æ–ª—å123!"
   ```

3. –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –∑–∞–¥–∞–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π: `ChangeMe123!@#`

4. **–í–ê–ñ–ù–û:** –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å!

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ `python manage.py migrate` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å email –∏–∑ `ROOT_ADMIN_EMAIL`
- –ï–º—É –ø—Ä–∏—Å–≤–∞–∏–≤–∞—é—Ç—Å—è: `role=ADMIN`, `is_staff=True`, `is_superuser=True`
- Root Admin –∑–∞—â–∏—â—ë–Ω –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–æ–ª–∏ —á–µ—Ä–µ–∑ API

**–í—Ö–æ–¥:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—ã—á–Ω—ã–π `/api/auth/login/` —Å email –∏ –ø–∞—Ä–æ–ª–µ–º
- –ò–ª–∏ —á–µ—Ä–µ–∑ Django admin: `/django-admin/`

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: Admin —á–µ—Ä–µ–∑ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ (AdminLoginAPI)

**–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–¥–º–∏–Ω–æ–≤:**

1. –î–æ–±–∞–≤—å—Ç–µ email –≤ `ADMIN_SEED_EMAILS` –≤ `settings.py`:
   ```python
   ADMIN_SEED_EMAILS = [
       "kazak_jenya@mail.ru",
       "second_admin@example.com",  # –≤—Ç–æ—Ä–æ–π –∞–¥–º–∏–Ω
   ]
   ```

2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/auth/admin-login/`:
   ```json
   POST /api/auth/admin-login/
   {
       "email": "second_admin@example.com",
       "password": "–∂–µ–ª–∞–µ–º—ã–π_–ø–∞—Ä–æ–ª—å"
   }
   ```

3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
   - –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 2 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞ –º–æ–≥—É—Ç —Å—Ç–∞—Ç—å —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–Ω –±—É–¥–µ—Ç –ø–æ–≤—ã—à–µ–Ω –¥–æ –∞–¥–º–∏–Ω–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–π "—Å–ª–æ—Ç")

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∞ —á–µ—Ä–µ–∑ Django shell

```python
python manage.py shell
```

```python
from accounts.models import User

# –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∞
admin = User.objects.create_user(
    email="admin@example.com",
    username="admin@example.com",
    password="–±–µ–∑–æ–ø–∞—Å–Ω—ã–π_–ø–∞—Ä–æ–ª—å",
    role=User.Roles.ADMIN,
    is_staff=True,
    is_superuser=True  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —Ç–æ–ª—å–∫–æ –¥–ª—è root-–∞–¥–º–∏–Ω–∞
)
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 4: –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∞ —á–µ—Ä–µ–∑ Django admin –ø–∞–Ω–µ–ª—å

1. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ root admin –≤ `/django-admin/`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏"
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
   - Email
   - –†–æ–ª—å: `ADMIN`
   - `is_staff = True`
   - `is_superuser = False` (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ root admin)

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ü–∞—Ä–æ–ª–∏:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ (–º–∏–Ω–∏–º—É–º 12 —Å–∏–º–≤–æ–ª–æ–≤, –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, —Å–∏–º–≤–æ–ª—ã)
   - –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ –∫–æ–¥–µ
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø–∞—Ä–æ–ª–µ–π

2. **Root Admin:**
   - –ó–∞—â–∏—â—ë–Ω –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–æ–ª–∏ —á–µ—Ä–µ–∑ API
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω root admin
   - Email root admin'–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º

3. **JWT —Ç–æ–∫–µ–Ω—ã:**
   - Access —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏
   - Refresh —Ç–æ–∫–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è access —Ç–æ–∫–µ–Ω–∞
   - –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ blacklist –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤

4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
   ```python
   DEBUG = False
   SECRET_KEY = os.getenv('SECRET_KEY')  # –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ –≤ –∫–æ–¥–µ!
   ALLOWED_HOSTS = ['yourdomain.com']
   ```

---

## üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –¢–µ—Å—Ç 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
```bash
curl -X POST http://localhost:8000/api/auth/register/ \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "Test123!@#",
    "parent_password": "Parent123!@#"
  }'
```

### –¢–µ—Å—Ç 2: –í—Ö–æ–¥
```bash
curl -X POST http://localhost:8000/api/auth/login/ \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "Test123!@#"
  }'
```

### –¢–µ—Å—Ç 3: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ–±–µ
```bash
curl -X GET http://localhost:8000/api/auth/me/ \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

### –¢–µ—Å—Ç 4: –í—Ö–æ–¥ –∞–¥–º–∏–Ω–∞
```bash
curl -X POST http://localhost:8000/api/auth/admin-login/ \
  -H "Content-Type: application/json" \
  -d '{
    "email": "kazak_jenya@mail.ru",
    "password": "ChangeMe123!@#"
  }'
```

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–î–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Root Admin:**

1. ‚úÖ –£–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `settings.py` (`ROOT_ADMIN_EMAIL = "kazak_jenya@mail.ru"`)
2. ‚úÖ –°–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏—è—Ö
3. ‚úÖ –ó–∞—â–∏—â—ë–Ω –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. ‚úÖ –ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:**
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏: `python manage.py migrate`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ root admin —Å–æ–∑–¥–∞–Ω
3. –í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ `/api/auth/login/` –∏–ª–∏ `/django-admin/`
4. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å!**

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

- –í—Å–µ –∞–¥–º–∏–Ω—Å–∫–∏–µ API —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è `IsAdminRole`
- Root Admin –≤—Å–µ–≥–¥–∞ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø, –¥–∞–∂–µ –µ—Å–ª–∏ –µ–≥–æ —Ä–æ–ª—å –∏–∑–º–µ–Ω–µ–Ω–∞
- –ê—É–¥–∏—Ç-–ª–æ–≥–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–æ–≤
- Django admin –ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É `/django-admin/` (—Ç—Ä–µ–±—É–µ—Ç `is_staff=True`)













